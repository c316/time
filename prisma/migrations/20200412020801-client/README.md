# Migration `20200412020801-client`

This migration has been generated by Joshua Bechard at 4/12/2020, 2:08:01 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Client" (
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "userId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."TimeEntry" ADD COLUMN "clientName" text   ;

CREATE UNIQUE INDEX "Client.name" ON "public"."Client"("name")

CREATE UNIQUE INDEX "Client.userId" ON "public"."Client"("userId")

ALTER TABLE "public"."Client" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."TimeEntry" ADD FOREIGN KEY ("clientName")REFERENCES "public"."Client"("name") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200412020801-client
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,40 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+model Client {
+  id     String @default(cuid()) @id
+  name   String @unique
+  userId String @unique
+  user   User   @relation(fields: [userId], references: [id])
+}
+
+model Profile {
+  bio    String?
+  id     String  @default(cuid()) @id
+  userId String  @unique
+  user   User    @relation(fields: [userId], references: [id])
+}
+
+model TimeEntry {
+  id         String    @default(cuid()) @id
+  start      DateTime
+  end        DateTime?
+  userId     String
+  user       User      @relation(fields: [userId], references: [id])
+  client     Client?   @relation(fields: [clientName], references: [name])
+  clientName String?
+}
+
+model User {
+  email       String      @unique
+  id          String      @default(cuid()) @id
+  name        String?
+  profile     Profile?
+  timeEntries TimeEntry[]
+}
```


